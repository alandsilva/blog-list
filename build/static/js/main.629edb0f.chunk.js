(this["webpackJsonpbloglist-frontend"]=this["webpackJsonpbloglist-frontend"]||[]).push([[0],{100:function(e,t,n){"use strict";n.r(t);var r,c=n(0),a=n.n(c),s=n(19),i=n.n(s),o=n(6),u=n.n(o),l=n(10),d=n(2),j=n(11),b=n(7),h=n(25),O=n.n(h),f="/api/blogs",p=null,x={getAll:function(){return O.a.get(f).then((function(e){return e.data}))},setToken:function(e){p="bearer ".concat(e)},create:function(){var e=Object(l.a)(u.a.mark((function e(t){var n,r;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={headers:{Authorization:p}},e.next=3,O.a.post(f,t,n);case 3:return r=e.sent,e.abrupt("return",r.data);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),update:function(){var e=Object(l.a)(u.a.mark((function e(t,n){var r;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,O.a.put("".concat(f,"/").concat(t),n);case 2:return r=e.sent,e.abrupt("return",r.data);case 4:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),remove:function(){var e=Object(l.a)(u.a.mark((function e(t){var n,r;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={headers:{Authorization:p}},e.next=3,O.a.delete("".concat(f,"/").concat(t),n);case 3:return r=e.sent,e.abrupt("return",r.data);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),addComment:function(){var e=Object(l.a)(u.a.mark((function e(t,n){var r;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,O.a.post("".concat(f,"/").concat(t,"/comments"),{comment:n});case 2:return r=e.sent,e.abrupt("return",r.data);case 4:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()},m=function(e,t,n){return function(){var c=Object(l.a)(u.a.mark((function c(a){return u.a.wrap((function(c){for(;;)switch(c.prev=c.next){case 0:clearTimeout(r),a({type:"SET_NOTIFICATION",data:{message:e,style:t}}),r=setTimeout((function(){a(v())}),1e3*n);case 3:case"end":return c.stop()}}),c)})));return function(e){return c.apply(this,arguments)}}()},v=function(){return{type:"REMOVE_NOTIFICATION"}},g=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_NOTIFICATION":return t.data;case"REMOVE_NOTIFICATION":return"";default:return e}},y=function(e){return function(){var t=Object(l.a)(u.a.mark((function t(n){var r;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,x.create(e);case 3:r=t.sent,n({type:"NEW_BLOG",data:r}),n(m("A new blog '".concat(r.title,"' by '").concat(r.author,"'"),"success",5)),t.next=11;break;case 8:t.prev=8,t.t0=t.catch(0),n(m("Failed to create blog","danger",5));case 11:case"end":return t.stop()}}),t,null,[[0,8]])})));return function(e){return t.apply(this,arguments)}}()},w=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"INIT_BLOGS":return t.data;case"NEW_BLOG":return e.concat(t.data);case"REMOVE_BLOG":return e.filter((function(e){return e.id!==t.data.id}));case"LIKE":case"COMMENT":return e.map((function(e){return e.id!==t.data.id?e:t.data}));default:return e}},k=n(9),E=function(e){var t=Object(c.useState)(""),n=Object(k.a)(t,2),r=n[0],a=n[1];return{type:e,value:r,onChange:function(e){a(e.target.value)},reset:function(){a("")}}},T=n(109),I=n(102),N=n(107),S=n(103),C=n(1),L=function(){var e=Object(j.b)(),t=Object(b.g)(),n=Object(b.f)(),r=Object(j.c)((function(e){return e.blogs.filter((function(e){return e.id===t.id}))}))[0],c=Object(j.c)((function(e){return e.auth.user})),a=E("text");return r?Object(C.jsxs)("div",{className:"container",children:[Object(C.jsx)(T.a,{children:Object(C.jsxs)(T.a.Body,{children:[Object(C.jsx)(T.a.Title,{children:r.title}),Object(C.jsx)(T.a.Subtitle,{className:"mb-2 text-muted",children:r.author}),Object(C.jsx)(T.a.Link,{href:r.url,children:r.url}),Object(C.jsxs)(T.a.Text,{children:["Likes ",Object(C.jsx)("span",{className:"like-value",children:r.likes})," ",Object(C.jsx)(I.a,{id:"like-button",variant:"outline-primary",onClick:function(){e(function(e){var t={user:e.user.id,likes:e.likes+1,author:e.author,title:e.title,url:e.url};return function(){var n=Object(l.a)(u.a.mark((function n(r){var c;return u.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,x.update(e.id,t);case 3:c=n.sent,console.log(c),r({type:"LIKE",data:c}),r(m("You liked '".concat(c.title,"'"),"success",5)),n.next=12;break;case 9:n.prev=9,n.t0=n.catch(0),r(m("Failed to like blog","danger",5));case 12:case"end":return n.stop()}}),n,null,[[0,9]])})));return function(e){return n.apply(this,arguments)}}()}(r))},children:"like"})]}),Object(C.jsx)(T.a.Text,{children:r.user.name})]})}),c.username===r.user.username&&Object(C.jsx)(T.a.Text,{children:Object(C.jsx)(I.a,{id:"remove-button",variant:"outline-danger",onClick:function(){var t;window.confirm("Remove blog '".concat(r.title,"' by '").concat(r.author,"?'"))&&(e((t=r.id,function(){var e=Object(l.a)(u.a.mark((function e(n){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,x.remove(t);case 3:n({type:"REMOVE_BLOG",data:{id:t}}),n(m("You deleted a blog","success",5)),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),n(m("Failed to delete blog","danger",5));case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t){return e.apply(this,arguments)}}())),n("/"))},children:"Delete"})}),Object(C.jsx)("h3",{children:"comments"}),Object(C.jsxs)(N.a,{onSubmit:function(t){t.preventDefault(),e(function(e,t){return function(){var n=Object(l.a)(u.a.mark((function n(r){var c;return u.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,x.addComment(e,t);case 3:c=n.sent,r({type:"COMMENT",data:c}),r(m("You commented on '".concat(c.title,"'"),"success",5)),n.next=11;break;case 8:n.prev=8,n.t0=n.catch(0),r(m("Failed to comment on blog","danger",5));case 11:case"end":return n.stop()}}),n,null,[[0,8]])})));return function(e){return n.apply(this,arguments)}}()}(r.id,a.value)),a.reset()},children:[Object(C.jsxs)(N.a.Group,{className:"mb-3",controlId:"formBasicEmail",children:[Object(C.jsx)(N.a.Control,Object(d.a)(Object(d.a)({},a),{},{reset:null,placeholder:"Enter comment"})),Object(C.jsx)(N.a.Text,{className:"text-muted",children:"Say what yout thought about this blog"})]}),Object(C.jsx)(I.a,{variant:"primary",type:"submit",children:"add comment"})]}),Object(C.jsx)(S.a,{striped:!0,children:Object(C.jsx)("tbody",{children:r.comments.map((function(e){return Object(C.jsx)("tr",{children:Object(C.jsx)("td",{children:e})},e+100*Math.random())}))})})]}):null},B=function(e){var t=e.createBlog,n=E("text"),r=E("text"),c=E("url");return Object(C.jsxs)("div",{children:[Object(C.jsx)("h2",{children:"create new"}),Object(C.jsxs)(N.a,{onSubmit:function(e){e.preventDefault();var a={title:n.value,author:r.value,url:c.value};t(a),n.reset(),r.reset(),c.reset()},children:[Object(C.jsxs)(N.a.Group,{className:"mb-3",controlId:"formBasicEmail",children:[Object(C.jsx)(N.a.Label,{children:"title"}),Object(C.jsx)(N.a.Control,Object(d.a)(Object(d.a)({id:"title"},n),{},{reset:null,placeholder:"Enter Title"}))]}),Object(C.jsxs)(N.a.Group,{className:"mb-3",controlId:"formBasicPassword",children:[Object(C.jsx)(N.a.Label,{children:"author"}),Object(C.jsx)(N.a.Control,Object(d.a)(Object(d.a)({id:"author"},r),{},{reset:null,placeholder:"Author McAuthor"}))]}),Object(C.jsxs)(N.a.Group,{className:"mb-3",controlId:"formBasicEmail",children:[Object(C.jsx)(N.a.Label,{children:"url"}),Object(C.jsx)(N.a.Control,Object(d.a)(Object(d.a)({id:"url"},c),{},{reset:null,placeholder:"https://url.com"}))]}),Object(C.jsx)(I.a,{id:"blogform-button",variant:"primary",type:"submit",children:"Submit"})]})]})},R={login:function(){var e=Object(l.a)(u.a.mark((function e(t){var n;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,O.a.post("/api/login",t);case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},_=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_CREDENTIALS":return t.data;case"REMOVE_CREDENTIALS":return null;default:return e}},A=function(){var e=Object(j.b)(),t=E("text"),n=E("password");return Object(C.jsxs)(N.a,{onSubmit:function(r){r.preventDefault();var c={username:t.value,password:n.value};e(function(e){return function(){var t=Object(l.a)(u.a.mark((function t(n){var r;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,R.login(e);case 3:r=t.sent,window.localStorage.setItem("loggedBloglistUser",JSON.stringify(r)),x.setToken(r.token),n({type:"SET_CREDENTIALS",data:{user:r}}),t.next=12;break;case 9:t.prev=9,t.t0=t.catch(0),n(m("Wrong credentials","danger",5));case 12:case"end":return t.stop()}}),t,null,[[0,9]])})));return function(e){return t.apply(this,arguments)}}()}(c))},children:[Object(C.jsxs)(N.a.Group,{className:"mb-3",controlId:"formBasicEmail",children:[Object(C.jsx)(N.a.Label,{children:"username"}),Object(C.jsx)(N.a.Control,Object(d.a)(Object(d.a)({id:"username"},t),{},{reset:null,placeholder:"Enter Username"}))]}),Object(C.jsxs)(N.a.Group,{className:"mb-3",controlId:"formBasicPassword",children:[Object(C.jsx)(N.a.Label,{children:"password"}),Object(C.jsx)(N.a.Control,Object(d.a)(Object(d.a)({id:"password"},n),{},{reset:null,placeholder:"Password"}))]}),Object(C.jsx)(I.a,{id:"login-button",variant:"primary",type:"submit",children:"Submit"})]})},M=a.a.forwardRef((function(e,t){var n=Object(c.useState)(!1),r=Object(k.a)(n,2),a=r[0],s=r[1],i={display:a?"none":""},o={display:a?"":"none"},u=function(){s(!a)};return Object(c.useImperativeHandle)(t,(function(){return{toggleVisibility:u}})),Object(C.jsxs)("div",{children:[Object(C.jsx)("div",{style:i,children:Object(C.jsx)(I.a,{onClick:u,children:e.buttonLabel})}),Object(C.jsxs)("div",{style:o,children:[e.children,Object(C.jsx)(I.a,{variant:"danger",onClick:u,children:"cancel"})]})]})}));M.displayName="Togglable";var G=M,D=n(104),F=function(){var e=Object(j.c)((function(e){return e.notification}));return Object(C.jsx)("div",{children:e.message&&Object(C.jsx)(D.a,{id:"notification",variant:e.style,children:e.message})})},V=n(22),U=function(){return O.a.get("/api/users").then((function(e){return e.data}))},J=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"INIT_USERS":return t.data;default:return e}},W=function(){var e=Object(j.c)((function(e){return e.users}));console.log(e);var t=Object(j.b)();return Object(c.useEffect)((function(){console.log("userlist useeffect"),t(function(){var e=Object(l.a)(u.a.mark((function e(t){var n;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,U();case 3:n=e.sent,console.log(n),t({type:"INIT_USERS",data:n}),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),console.log("failed to get users");case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t){return e.apply(this,arguments)}}())}),[t]),Object(C.jsxs)("div",{children:[Object(C.jsx)("h3",{children:"Users"}),Object(C.jsx)(S.a,{striped:!0,children:Object(C.jsxs)("tbody",{children:[Object(C.jsxs)("tr",{children:[Object(C.jsx)("th",{}),Object(C.jsx)("th",{children:"blogs created"})]}),e.map((function(e){return Object(C.jsxs)("tr",{children:[Object(C.jsx)("td",{children:Object(C.jsx)(V.b,{to:"/users/".concat(e.id),children:e.name})}),Object(C.jsx)("td",{children:e.blogs.length})]},e.id)}))]})})]})},P=function(){var e=Object(b.g)(),t=Object(j.c)((function(t){return t.users.filter((function(t){return t.id===e.id}))}))[0];return t?Object(C.jsxs)("div",{children:[Object(C.jsx)("h2",{children:t.name}),Object(C.jsx)("h3",{children:"added blogs"}),Object(C.jsx)(S.a,{striped:!0,children:Object(C.jsx)("tbody",{children:t.blogs.map((function(e){return Object(C.jsx)("tr",{children:Object(C.jsxs)("td",{children:[e.title," - ",e.author]})},e.id)}))})})]}):null},Y=n(106),z=n(105),H=n(108),K=function(){var e=Object(j.b)(),t=Object(j.c)((function(e){return e.auth}));return Object(C.jsx)(Y.a,{bg:"light",expand:"lg",children:Object(C.jsxs)(z.a,{fluid:!0,children:[Object(C.jsx)(Y.a.Brand,{href:"#",as:"span",children:Object(C.jsx)(V.b,{to:"/",children:"blogs"})}),Object(C.jsx)(Y.a.Toggle,{"aria-controls":"navbarScroll"}),Object(C.jsxs)(Y.a.Collapse,{id:"navbarScroll",children:[Object(C.jsx)(H.a,{className:"me-auto my-2 my-lg-0",style:{maxHeight:"100px"},navbarScroll:!0,children:Object(C.jsx)(H.a.Link,{href:"#",as:"span",children:Object(C.jsx)(V.b,{to:"/users",children:"users"})})}),Object(C.jsxs)(H.a,{className:"d-flex",children:[Object(C.jsxs)(H.a.Link,{href:"#",disabled:!0,children:[t.user.name," logged in"]}),Object(C.jsx)(I.a,{variant:"outline-danger",onClick:function(){e(function(){var e=Object(l.a)(u.a.mark((function e(t){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:window.localStorage.removeItem("loggedBloglistUser"),x.setToken(null),t({type:"REMOVE_CREDENTIALS"});case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())},children:"Logout"})]})]})]})})},q=(n(99),function(){var e=Object(j.c)((function(e){return e.blogs})),t=Object(j.c)((function(e){return e.auth})),n=Object(j.b)(),r=Object(c.useRef)(),a=function(){var e=Object(l.a)(u.a.mark((function e(t){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n(y(t)),r.current.toggleVisibility();case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();Object(c.useEffect)((function(){n(function(){var e=Object(l.a)(u.a.mark((function e(t){var n;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,x.getAll();case 2:n=e.sent,t({type:"INIT_BLOGS",data:n});case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}),[]),Object(c.useEffect)((function(){n(function(){var e=Object(l.a)(u.a.mark((function e(t){var n,r;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:(n=window.localStorage.getItem("loggedBloglistUser"))&&(r=JSON.parse(n),t({type:"SET_CREDENTIALS",data:{user:r}}),x.setToken(r.token));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}),[]);return Object(C.jsxs)("div",{className:"container",children:[Object(C.jsx)(F,{}),null===t?Object(C.jsx)(A,{}):Object(C.jsxs)("div",{children:[Object(C.jsx)(K,{}),Object(C.jsx)("h2",{children:"blogs"}),Object(C.jsxs)(b.c,{children:[Object(C.jsx)(b.a,{path:"/users/:id",element:Object(C.jsx)(P,{})}),Object(C.jsx)(b.a,{path:"/users",element:Object(C.jsx)(W,{})}),Object(C.jsx)(b.a,{path:"/blogs/:id",element:Object(C.jsx)(L,{})}),Object(C.jsx)(b.a,{path:"/",element:Object(C.jsxs)("div",{children:[Object(C.jsx)(G,{buttonLabel:"create Blog",ref:r,children:Object(C.jsx)(B,{createBlog:a})}),Object(C.jsx)(S.a,{striped:!0,children:Object(C.jsx)("tbody",{children:e.map((function(e){return Object(C.jsx)("tr",{children:Object(C.jsx)("td",{children:Object(C.jsxs)(V.b,{to:"/blogs/".concat(e.id),children:[e.title," - ",e.author]})})},e.id)}))})})]})})]})]})]})}),Q=n(42),X=n(66),Z=n(65),$=Object(Q.combineReducers)({notification:g,blogs:w,auth:_,users:J}),ee=Object(Q.createStore)($,Object(Z.composeWithDevTools)(Object(Q.applyMiddleware)(X.a)));i.a.render(Object(C.jsx)(j.a,{store:ee,children:Object(C.jsx)(V.a,{children:Object(C.jsx)(q,{})})}),document.getElementById("root"))},99:function(e,t,n){}},[[100,1,2]]]);
//# sourceMappingURL=main.629edb0f.chunk.js.map